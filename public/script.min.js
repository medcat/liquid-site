$(function(){"use strict"
var keyBind,refreshBox,setCursorPos
$("body").scrollspy({target:".main-nav"}),$("pre:not(.no-highlight)").each(function(e,t){var o,r=$(t)
r.addClass("display"),o=$("<code />"),o.addClass("compiled highlight"),$.ajax({url:"https://liquidscript.io/run",type:"POST",dataType:"json",data:{code:r.text(),type:"generated"},success:function(e){!e.error&&e.result&&(o.html($(e.result).children("div pre").html()),r.append(o))}})}),refreshBox=function(){$("#try code.compiled").removeClass("error"),$.ajax({url:"https://liquidscript.io/run",type:"POST",dataType:"json",data:{code:$("#try textarea").val(),type:"generated"},success:function(e){!e.error&&e.result?$("#try code.compiled").html($(e.result).children("div pre").html()):($("#try code.compiled").text(e.error),$("#try code.compiled").addClass("error"))}})},setCursorPos=function(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t)
else if(e.createTextRange){var o=e.createTextRange()
o.collapse(!0),o.moveEnd("character",t),o.moveStart("character",t),o.select()}},$("#try").append("<code class='compiled highlight'></code>"),$("#try textarea").on("keydown",function(e){if(keyBind&&clearTimeout(keyBind),9===e.keyCode){e.preventDefault()
var t="  ",o=this.selectionStart,r=$(this).val()
$(this).val(r.substring(0,o)+t+r.substring(o)),o+=t.length,setCursorPos(this,o)}else if(13===e.keyCode){e.preventDefault()
var s,n,o=this.selectionStart,r=$(this).val()
for(s=o-1;s>=0&&"\n"!=r[s];--s);for(n=o;n<r.length&&"\n"!=r[n];++n);var a=r.substring(s+1,n-1),i=/^(\s*)/.exec(a)[1]
a===i&&(i+=" "),$(this).val(r.substring(0,o)+"\n"+i+r.substring(o)),setCursorPos(this,o+1+i.length)}keyBind=setTimeout(refreshBox,500)}),$.ajax({url:"https://liquidscript.io/version",success:function(e){$("#brand").append(" v"+e)}}),fakeConsole=window.fakeConsole={},fakeConsole._buffer="",fakeConsole.concat=function(){for(var e=0;e<arguments.length;e++)arguments[e]&&""+arguments[e]&&(fakeConsole._buffer+=""+arguments[e]),fakeConsole._buffer+="\n"},fakeConsole.warn=fakeConsole.error=fakeConsole.log=fakeConsole.concat,$("#run").click(function(){var code=$("#try code.compiled").text(),toExec="(function(console){"+code+"})(window.fakeConsole)"
try{var output=eval(toExec),result=""
fakeConsole._buffer&&(result+="Console log:\n\n"+fakeConsole._buffer),output&&(result+=(result?"\n\n":"")+"Output:\n\n"+output),$("#output").text(result||"Code did not return any output")}catch(e){$("#output").text(e)}fakeConsole._buffer=""}),$("#examples").change(function(){var e=$(this).find("option:selected").val()
$.get("/examples/"+e,function(e){$("#try textarea").val(e),refreshBox(),$("#try textarea").trigger("autosize.resize")})}),$("#input").autosize(),$("#input").trigger("autosize.resize"),refreshBox()})